<!DOCTYPE HTML>
<html>
	<head>
		<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
		<title>Highcharts Example</title>

		<script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.7.1/jquery.min.js"></script>
		<script type="text/javascript">
var chart;
var setRange;
$(function () {
    var data = {"month": [{"usage": {"traffic": 0.0, "cputime": 0.0, "diskspace": 0.0, "memory": 0.0}, "type": "month", "begin": 1343779200.0, "measurements": 0, "end": 1346457600.0}], "5minutes": [{"usage": {"traffic": 88374.0, "cputime": 1.627750434241392, "diskspace": 248428746.0, "memory": 80863232.0}, "type": "5minutes", "begin": 1346937900.0, "measurements": 40, "end": 1346938200.0}, {"usage": {"traffic": 70148.0, "cputime": 1.3381506637321365, "diskspace": 248430794.0, "memory": 80863232.0}, "type": "5minutes", "begin": 1346938200.0, "measurements": 32, "end": 1346938500.0}, {"usage": {"traffic": 71322.0, "cputime": 1.2582610718675085, "diskspace": 248434890.0, "memory": 80863232.0}, "type": "5minutes", "begin": 1346938500.0, "measurements": 32, "end": 1346938800.0}, {"usage": {"traffic": 77186.0, "cputime": 1.3980678576305934, "diskspace": 248436938.0, "memory": 80863232.0}, "type": "5minutes", "begin": 1346938800.0, "measurements": 40, "end": 1346939100.0}, {"usage": {"traffic": 70784.0, "cputime": 1.2682472708505372, "diskspace": 248436938.0, "memory": 80863232.0}, "type": "5minutes", "begin": 1346939100.0, "measurements": 32, "end": 1346939400.0}, {"usage": {"traffic": 85666.0, "cputime": 1.5278884444106495, "diskspace": 248436938.0, "memory": 80863232.0}, "type": "5minutes", "begin": 1346939400.0, "measurements": 40, "end": 1346939700.0}, {"usage": {"traffic": 68850.0, "cputime": 1.2183162759352228, "diskspace": 248436938.0, "memory": 80863232.0}, "type": "5minutes", "begin": 1346939700.0, "measurements": 32, "end": 1346940000.0}, {"usage": {"traffic": 75832.0, "cputime": 1.3481368627151653, "diskspace": 248436938.0, "memory": 80863232.0}, "type": "5minutes", "begin": 1346940000.0, "measurements": 32, "end": 1346940300.0}, {"usage": {"traffic": 84368.0, "cputime": 1.607778036275164, "diskspace": 248441034.0, "memory": 80863232.0}, "type": "5minutes", "begin": 1346940300.0, "measurements": 40, "end": 1346940600.0}, {"usage": {"traffic": 67580.0, "cputime": 1.3381506637321934, "diskspace": 248444106.0, "memory": 80863232.0}, "type": "5minutes", "begin": 1346940600.0, "measurements": 32, "end": 1346940900.0}, {"usage": {"traffic": 71191.0, "cputime": 1.1384266840706516, "diskspace": 248445130.0, "memory": 80863232.0}, "type": "5minutes", "begin": 1346940900.0, "measurements": 32, "end": 1346941200.0}, {"usage": {"traffic": 82653.0, "cputime": 1.4979298474613927, "diskspace": 248445130.0, "memory": 80863232.0}, "type": "5minutes", "begin": 1346941200.0, "measurements": 40, "end": 1346941500.0}], "day": [{"usage": {"traffic": 0.0, "cputime": 0.0, "diskspace": 0.0, "memory": 0.0}, "type": "day", "begin": 1346716800.0, "measurements": 0, "end": 1346803200.0}, {"usage": {"traffic": 9803290.4772689, "cputime": 195.14031034388154, "diskspace": 248147426.29081947, "memory": 80728313.84842883}, "type": "day", "begin": 1346803200.0, "measurements": 4328, "end": 1346889600.0}], "hour": [{"usage": {"traffic": 821154.0, "cputime": 15.218638117959102, "diskspace": 248097869.12195122, "memory": 80731360.7804878}, "type": "hour", "begin": 1346853600.0, "measurements": 328, "end": 1346857200.0}, {"usage": {"traffic": 895506.0, "cputime": 16.33744867187383, "diskspace": 248111781.97037035, "memory": 80728064.0}, "type": "hour", "begin": 1346857200.0, "measurements": 360, "end": 1346860800.0}, {"usage": {"traffic": 907100.0, "cputime": 16.517200552126752, "diskspace": 248126821.82608697, "memory": 80728064.0}, "type": "hour", "begin": 1346860800.0, "measurements": 368, "end": 1346864400.0}, {"usage": {"traffic": 901712.0, "cputime": 16.407352180861068, "diskspace": 248139532.7826087, "memory": 80728064.0}, "type": "hour", "begin": 1346864400.0, "measurements": 368, "end": 1346868000.0}, {"usage": {"traffic": 883734.0, "cputime": 16.137724360481798, "diskspace": 248155952.4, "memory": 80728064.0}, "type": "hour", "begin": 1346868000.0, "measurements": 360, "end": 1346871600.0}, {"usage": {"traffic": 903692.0, "cputime": 16.26754516288662, "diskspace": 248170267.6231884, "memory": 80728064.0}, "type": "hour", "begin": 1346871600.0, "measurements": 368, "end": 1346875200.0}, {"usage": {"traffic": 888638.0, "cputime": 16.377393534152247, "diskspace": 248183623.15555555, "memory": 80728064.0}, "type": "hour", "begin": 1346875200.0, "measurements": 360, "end": 1346878800.0}, {"usage": {"traffic": 910226.0, "cputime": 16.44729704313957, "diskspace": 248197767.2173913, "memory": 80728064.0}, "type": "hour", "begin": 1346878800.0, "measurements": 368, "end": 1346882400.0}, {"usage": {"traffic": 906126.0, "cputime": 16.65700757010123, "diskspace": 248212025.3043478, "memory": 80728064.0}, "type": "hour", "begin": 1346882400.0, "measurements": 368, "end": 1346886000.0}, {"usage": {"traffic": 888390.0, "cputime": 15.957972480228818, "diskspace": 248226130.53333333, "memory": 80728064.0}, "type": "hour", "begin": 1346886000.0, "measurements": 360, "end": 1346889600.0}, {"usage": {"traffic": 897592.0, "cputime": 16.766855941366913, "diskspace": 248240330.0, "memory": 80728064.0}, "type": "hour", "begin": 1346889600.0, "measurements": 368, "end": 1346893200.0}, {"usage": {"traffic": 893040.0, "cputime": 16.447297043139514, "diskspace": 248252841.8251366, "memory": 80728064.0}, "type": "hour", "begin": 1346893200.0, "measurements": 366, "end": 1346896800.0}, {"usage": {"traffic": 890560.0, "cputime": 18.853974995414262, "diskspace": 248267236.87292817, "memory": 80847549.52486187}, "type": "hour", "begin": 1346896800.0, "measurements": 362, "end": 1346900400.0}, {"usage": {"traffic": 914421.0, "cputime": 16.597090276683645, "diskspace": 248281564.55072466, "memory": 80863232.0}, "type": "hour", "begin": 1346900400.0, "measurements": 368, "end": 1346904000.0}, {"usage": {"traffic": 889058.0, "cputime": 16.307490025165066, "diskspace": 248295944.57777777, "memory": 80863232.0}, "type": "hour", "begin": 1346904000.0, "measurements": 360, "end": 1346907600.0}, {"usage": {"traffic": 905181.0, "cputime": 16.72691107908838, "diskspace": 248309605.82608697, "memory": 80863232.0}, "type": "hour", "begin": 1346907600.0, "measurements": 368, "end": 1346911200.0}, {"usage": {"traffic": 910672.0, "cputime": 16.56713162997488, "diskspace": 248328304.95652175, "memory": 80863232.0}, "type": "hour", "begin": 1346911200.0, "measurements": 368, "end": 1346914800.0}, {"usage": {"traffic": 812398.0, "cputime": 14.76961282744594, "diskspace": 248341631.07317072, "memory": 80863232.0}, "type": "hour", "begin": 1346914800.0, "measurements": 328, "end": 1346918400.0}, {"usage": {"traffic": 890140.0, "cputime": 16.5471591988356, "diskspace": 248356590.0296296, "memory": 80863232.0}, "type": "hour", "begin": 1346918400.0, "measurements": 360, "end": 1346922000.0}, {"usage": {"traffic": 923420.0, "cputime": 16.895247499655056, "diskspace": 248376364.01142856, "memory": 80863232.0}, "type": "hour", "begin": 1346922000.0, "measurements": 350, "end": 1346925600.0}, {"usage": {"traffic": 902929.0, "cputime": 16.357412183105424, "diskspace": 248390898.96, "memory": 80863232.0}, "type": "hour", "begin": 1346925600.0, "measurements": 400, "end": 1346929200.0}, {"usage": {"traffic": 898277.0, "cputime": 16.51717042835938, "diskspace": 248405140.61611375, "memory": 80863232.0}, "type": "hour", "begin": 1346929200.0, "measurements": 422, "end": 1346932800.0}, {"usage": {"traffic": 892092.0, "cputime": 16.267649241811114, "diskspace": 248418369.13365856, "memory": 80866828.48780487}, "type": "hour", "begin": 1346932800.0, "measurements": 410, "end": 1346936400.0}, {"usage": {"traffic": 896468.0, "cputime": 16.427297327159465, "diskspace": 248432211.84615386, "memory": 80863232.0}, "type": "hour", "begin": 1346936400.0, "measurements": 416, "end": 1346940000.0}], "year": [{"usage": {"traffic": 0.0, "cputime": 0.0, "diskspace": 0.0, "memory": 0.0}, "type": "year", "begin": 1293840000.0, "measurements": 0, "end": 1325376000.0}]};
    $(document).ready(function() {
        var traffic = {};
        var memory = {};
        var cputime = {};
        var diskspace = {};
        for (var range in data) {
            traffic[range] = [];
            memory[range] = [];
            diskspace[range] = [];
            cputime[range] = [];
            for (var i=0; i<data[range].length; i++) {
                var rec = data[range][i];
                traffic[range].push([rec.end * 1000, rec.usage.traffic]);
                memory[range].push([rec.end * 1000, rec.usage.memory]);
                cputime[range].push([rec.end * 1000, rec.usage.cputime]);
                diskspace[range].push([rec.end * 1000, rec.usage.diskspace]);
            }        
        }
        var formatSize = function(value) {
            suffix = 0;
            while (value > 1000) {
                value /= 1000.0;
                suffix++;
            }
            return Math.round(value*100)/100 + " " + ["Bytes", "KB", "MB", "GB", "TB"][suffix];
        };
        var formatTime = function(value) {
            suffix = 0;
            if (value >= 60) {
                value /= 60.0;
                suffix++;
            }
            if (value >= 60) {
                value /= 60.0;
                suffix++;
            }
            return Math.round(value*100)/100 + " " + ["s", "min", "h"][suffix];
        };
        var colors = Highcharts.getOptions().colors;
        setRange = function(range) {
            chart.series[0].remove(true);
            chart.series[0].remove(true);
            chart.series[0].remove(true);
            chart.series[0].remove(true);
            chart.addSeries({name: 'Memory', data: memory[range], yAxis: 0, color: colors[0]});
            chart.addSeries({name: 'Diskspace', data: diskspace[range], yAxis: 0, color: colors[1]});
            chart.addSeries({name: 'Traffic', data: traffic[range], yAxis: 0, color: colors[2]});
            chart.addSeries({name: 'CPU Time', data: cputime[range], yAxis: 1, color: colors[3]});
        }
        chart = new Highcharts.Chart({
            chart: {
                renderTo: 'container',
                type: 'spline'
            },
            title: {
                text: 'Resource Usage'
            },
            subtitle: {
                text: 'Topology #1'
            },
            xAxis: {
                type: 'datetime'
            },
            yAxis: [{
                labels: {
                    formatter: function() {
                        return formatSize(this.value);
                    }
                },
                title: {
                    text: 'Memory/Diskspace/Traffic'
                },
                min: 0
            }, {
                labels: {
                    formatter: function() {
                        return formatTime(this.value);
                    }
                },
                title: {
                    text: 'CPU Time'
                },
                min: 0,
                opposite: true
            }],
            tooltip: {
                formatter: function() {
                        return '<b>'+ this.series.name +'</b><br/>'+
                        Highcharts.dateFormat('%Y-%m-%d %H:%M', this.x) +' '+ [formatSize, formatTime][this.series.yAxis.options.index](this.y);
                }
            },
            
            series: [{
                name: 'Memory',
                data: memory["5minutes"],
                yAxis: 0
            }, {
                name: 'Diskspace',
                data: diskspace["5minutes"],
                yAxis: 0
            }, {
                name: 'Traffic',
                data: traffic["5minutes"],
                yAxis: 0
            }, {
                name: 'CPU-Time',
                data: cputime["5minutes"],
                yAxis: 1
            }]
        });
    });
    
});
		</script>
	</head>
	<body>
<script src="../../js/highcharts.js"></script>
<script src="../../js/modules/exporting.js"></script>

<b>Interval: </b>
<select onchange="setRange(this.options[this.selectedIndex].value);">
  <option value="year">Years</option>
  <option value="month">Months</option>
  <option value="day">Days</option>
  <option value="hour">Hours</option>
  <option value="5minutes" selected>5 Minutes</option>
</select>
<div id="container" style="min-width: 400px; height: 400px; margin: 0 auto"></div>

	</body>
</html>
