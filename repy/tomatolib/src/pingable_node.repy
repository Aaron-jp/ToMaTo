#include <icmp_node.repy>
#include <parse_args.repy>
#include <run_forever.repy>
#include <ip_util.repy>
#include <mac_util.repy>

if callfunc == 'initialize':
    defaults = {"ip":"10.0.0.1", "mac":random_mac()}
    options = parse_args(defaults)
    echo("Options: %s" % options)
    options["ip"] = str_to_ip(options["ip"])
    node = ICMPNode(**options)
    run_forever(node.handle)